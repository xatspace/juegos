<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorteador con Chat Xat.com</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* BARRA SUPERIOR (SORTEADOR) */
        .top-bar { 
            display: flex; background: #111; padding: 10px; height: 180px; 
            border-bottom: 2px solid #ff00ff; align-items: center; justify-content: space-around;
        }

        .visor-mini { width: 100px; height: 150px; background: #fff; border: 2px solid #ff00ff; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; }
        #img-carta { width: 100%; height: 120px; object-fit: contain; }
        #nombre-carta { color: #000; background: #fff; text-align: center; font-size: 10px; font-weight: bold; height: 30px; display: flex; align-items: center; justify-content: center; border-top: 1px solid #000; }

        .controles { display: flex; flex-direction: column; gap: 8px; }
        .botones { display: flex; gap: 5px; }
        button { padding: 8px; font-size: 10px; font-weight: bold; cursor: pointer; border-radius: 4px; border: none; text-transform: uppercase; }
        .btn-play { background: #39ff14; }
        .btn-pause { background: #ffeb3b; }
        .btn-copy { background: #00e5ff; width: 100%; }

        /* AREA DEL CHAT XAT.COM */
        .chat-container { flex-grow: 1; background: #222; position: relative; }
        iframe { width: 100%; height: 100%; border: none; }

        .speed-text { font-size: 10px; color: #ffeb3b; text-align: center; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="visor-mini">
            <img src="" id="img-carta" style="display:none;">
            <div id="nombre-carta">ESPERANDO</div>
        </div>

        <div class="controles">
            <div style="text-align: center; font-size: 12px; color: #ff00ff;">LOTERÍA MEXICANA</div>
            <input type="text" id="txt-copiar" readonly style="background:#000; color:#39ff14; border:1px solid #333; text-align:center; padding:5px; font-size:12px;" placeholder="Carta actual">
            <button class="btn-copy" onclick="copiarAlPortapapeles()">COPIAR PARA EL CHAT</button>
            <div id="status-copia" style="font-size: 9px; text-align: center; height: 10px; color: #39ff14;"></div>
        </div>

        <div class="controles">
            <div class="botones">
                <button class="btn-play" id="btn-play" onclick="comenzar()">▶ Play</button>
                <button class="btn-pause" id="btn-pause" onclick="pausar()" disabled>⏸ Pausa</button>
            </div>
            <div class="speed-text">VELOCIDAD: <span id="val-vel">4</span>s</div>
            <input type="range" min="2" max="8" step="1" value="4" oninput="cambiarVel(this.value)" style="width: 80px;">
        </div>
    </div>

    <div class="chat-container">
        <iframe src="https://xat.com/embed/chat.php#id=219560413&gn=TuSala" allowtransparency="true"></iframe>
    </div>

    <script>
        const RUTA_IMG = "mexicana/img/";
        const nombres = ["Gallo", "Diablito", "Dama", "Catrín", "Paraguas", "Sirena", "Escalera", "Botella", "Barril", "Árbol", "Melón", "Valiente", "Gorrito", "Muerte", "Pera", "Bandera", "Bandolón", "Violoncello", "Garza", "Pájaro", "Mano", "Bota", "Luna", "Cotorro", "Borracho", "Negrito", "Corazón", "Sandía", "Tambor", "Camarón", "Jaras", "Músico", "Araña", "Soldado", "Estrella", "Cazo", "Mundo", "Apache", "Nopal", "Alacrán", "Rosa", "Calavera", "Campana", "Cantarito", "Venado", "Sol", "Corona", "Chalupa", "Pino", "Pescado", "Palma", "Maceta", "Arpa", "Rana"];
        
        let mazo = [], indiceActual = 0, intervalo = null, velocidad = 4;

        function cambiarVel(v) { velocidad = v; document.getElementById('val-vel').innerText = v; if(intervalo) { pausar(); comenzar(); } }

        function copiarAlPortapapeles() {
            const temp = document.getElementById('txt-copiar');
            if(!temp.value) return;
            temp.select();
            document.execCommand('copy');
            document.getElementById('status-copia').innerText = "¡COPIADO!";
            setTimeout(() => document.getElementById('status-copia').innerText = "", 1000);
        }

        function prepararMazo() {
            mazo = nombres.map((nom, i) => ({ id: i + 1, nombre: nom }));
            mazo.sort(() => Math.random() - 0.5);
        }

        function comenzar() {
            if (mazo.length === 0) prepararMazo();
            document.getElementById('btn-play').disabled = true;
            document.getElementById('btn-pause').disabled = false;
            sacarCarta();
            intervalo = setInterval(sacarCarta, velocidad * 1000);
        }

        function pausar() {
            clearInterval(intervalo);
            intervalo = null;
            document.getElementById('btn-play').disabled = false;
            document.getElementById('btn-pause').disabled = true;
        }

        function sacarCarta() {
            if (indiceActual >= mazo.length) { pausar(); return; }
            const carta = mazo[indiceActual];
            document.getElementById('img-carta').src = RUTA_IMG + carta.id + ".jpg";
            document.getElementById('img-carta').style.display = "block";
            document.getElementById('nombre-carta').innerText = carta.nombre.toUpperCase();
            
            const texto = "☆ " + carta.nombre.toUpperCase() + " ☆";
            document.getElementById('txt-copiar').value = texto;
            
            // Intento de autocopia (aunque el navegador lo bloquee, tenemos el botón manual arriba)
            document.getElementById('txt-copiar').select();
            document.execCommand('copy');

            indiceActual++;
        }
    </script>
</body>
</html>
